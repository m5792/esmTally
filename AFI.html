  <!-- üîπ Footer -->

  <style>
  body {
    margin: 0;
    padding-bottom: 60px; /* Footer ke liye space */
    font-family: Arial, sans-serif;
  }

  /* üîπ Fixed Footer */
  .fixed-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #035b67;
    color: rgb(2, 64, 118);
    text-align: center;
    padding: 12px 0;
    font-size: 14px;
    box-shadow: 0 -2px 6px rgba(0,0,0,0.3);
    z-index: 999;
  }
</style>

<!-- footer start hare) -->
  <div class="fixed-footer">



<!-- ================================================================================================================================== -->
    <div style="
    max-width: 100%;
    margin: 15px auto;
    padding: 15px;
    border-radius: 12px;
    background: #f8f9fa;
    box-shadow: 0 3px 10px rgba(0,0,0,0.15);
    font-family: Arial, sans-serif;
">

    <h2 style="margin:0; color:#035b67; text-align:center;">
         A.F.I Cure Medical Store
    </h2>

    <hr style="margin:10px 0; border:0; border-top:1px solid #ddd;">

    <p style="margin:6px 0;"><strong>üè¢ Propriter:</strong> Mukhtar Ahamad</p>
    <p style="margin:6px 0;"><strong>üìç Address:</strong> Near PNB Bank Kundeshwari, Kashipur U.S.Nagar, Uttarakhand-244713</p>
    <p style="margin:6px 0;"><strong>üìû Contact:</strong> +91 9756735792, 8057925792 |
    <strong>üìß Email:</strong> eservicesksp@gmail.com</p>
    <p style="margin:6px 0;"><strong>üíº DL No:</strong> UA-UDH-143538 | UA-UDH-14539  (Exp. 07-Nov-2030)</p>

    <hr style="margin:10px 0; border:0; border-top:1px solid #ddd;">

   
</div>

<!-- ================================================================================================================================== -->


<!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Dropdown URL  Script Start Heare -->
<!DOCTYPE html>
<html>
<head>

    <script>
        // Function to handle dropdown selection
        function handleDropdownChange() {
            const dropdown = document.getElementById('linkDropdown');
            const selectedOption = dropdown.options[dropdown.selectedIndex];

            if (selectedOption.value) {
                // Open the link in a new tab
                window.open(selectedOption.value, '_blank');
            }
        }
    </script>
    <style>
        select {
            padding:5px;
            font-size: 14px;
            margin: 2px 0;
        }
    </style>
</head>
<body>

 <label style="color: #f6fead;"> Google Sheet Links</label>
    <select id="linkDropdown" onchange="handleDropdownChange()">
        <option value="">--Google Sheet Links --</option>

	<option value="https://www.google.com/android/find/">	Find My Device</option>
	<option value="https://docs.google.com/spreadsheets/d/1wvsPdAQA57HxhTxA3cCcQvUEz93IWkBre_Ix-qvzwss/edit?gid=627393391#gid=627393391">	Store Database SHeet*</option>
	<option value="https://docs.google.com/spreadsheets/d/1U_jwvZNtFuP91Gljjrbz_cpmb1OIkeDHnKa7aDe7F20/edit?gid=1511450281#gid=1511450281">	Clint List Sheet*</option>
	<option value="https://docs.google.com/spreadsheets/d/17GZv2O6uupdA5r6p7-zqKZ8AQgZozbGQf2aXPlUzhDA/edit?gid=1122888223#gid=1122888223">	Mipl Office</option>
	<option value="https://docs.google.com/spreadsheets/d/13N0HBuorZJM-ARnlTh36EUaD1-uQckaC6sLLzMnWAks/edit?gid=696561165#gid=696561165">	Office Noida</option>
	<option value="https://docs.google.com/spreadsheets/d/1Rw_6cDYP-ETicn9YhHkdF_Sgmi8ps5JhjhlrkWvtwRQ/edit?gid=2123243236#gid=2123243236">	GUPTA CAMUNICATION Sheet*</option>
    <option value="https://docs.google.com/spreadsheets/d/1cXqnV7kKebvzk6-BAuuBNSmDnpJOyCqh7LRVB6sHiL4/edit?gid=0#gid=0">	INDEX SHEET MIPL Sheet*</option>
    <option value="https://docs.google.com/spreadsheets/d/1B6dyXPay3Tyl_7RzGuL9Rg8AhkzdBNhJNRu-T-3kmvI/edit?gid=147958071#gid=147958071">	MIPL Clint Cash Ledger Sheet*</option>
     <option value="https://docs.google.com/spreadsheets/d/1ECwXrxs8_FDWw1qAC6_qxEwP_HE3SGMM4qNKVZHlIS0/edit?gid=0#gid=0">	Cash Management Sheet*</option>
     <option value="https://docs.google.com/spreadsheets/d/1h3uC_0Ji4-NUhqrN0aIR-XwLZL5VdgilCBlIzC--SDA/edit?gid=0#gid=0">	Imprest Voucher Sheet*</option>
      <option value="https://docs.google.com/spreadsheets/d/1B6dyXPay3Tyl_7RzGuL9Rg8AhkzdBNhJNRu-T-3kmvI/edit?pli=1&gid=207048997#gid=207048997">	MIPL Party Weight REport*</option>
     <option value="https://docs.google.com/spreadsheets/d/1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k/edit?gid=809921823#gid=809921823">	A.F.I Google Index Sheet</option>
      <option value="MULTITECH V.2023.html">	MIPL DASHBOARD OLD</option>
     <option value="MULTITECH2023.html">MIPL Old Dashboard</option>
     <option value="https://github.com/">	github (mukhtarahamadksp@gmail.com)</option>
     <option value="eTally.html">	eTally Dashboard</option>
		<option value="DAYBOOK.html">Daybook</option>
    </select>
</body>
</html>


  </div>  <!-- footer stop hare -->








<!-- ===============================
     AFI STOCK UI (BUTTON MODE)
================================== -->
<div style="text-align:center; background-color: #013647; color: #c9eef8; font-weight: bold;"> <strong>A.F.I Cure Medical - Dishplay Report</strong></div> <br/>

<style>


/* Table Styling */
/* Container to control table width and responsiveness */
.table-container {
  width: 100%;
  overflow-x: auto;
}

 
 /* Table container ************/
table{
    width: 100%;
  border-collapse: collapse;
  table-layout: auto;
  font-family: Arial, sans-serif;
  font-size: 14px;
  background: #ffffff;
  border: 1px solid #d0d0d0;

  }

/* Optional heder alwayas fix on top and table scrolling  */
  table{
  overflow-x: auto;
  display: block;
  max-height: 550px; /* Optional scrolling */
  }

  /* Table border & cell style */
th {
   background: #01305c;
  color: #ffffff;
  padding: 10px;
  border: 1px solid #b5b5b5;
  text-align: left;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 1;
  white-space: nowrap;
  }


 td {
   padding: 8px 10px;
  border: 1px solid #e0e0e0;
  vertical-align: top;
  word-wrap: break-word; /* Wrap long text */
  white-space: normal;
  }

  /* Header design */


  tr:nth-child(even) {
  background-color: #f9f9f9;
}

  /* Row hover effect */
  tr:hover td {
   background: #fccc49;
 color: rgb(0, 15, 15);
  transition: background-color 1s ease, color 1s ease;
  }
    


.filter-btn {
  background: #035b67;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.2s ease;
  min-width: 90px;            /* optional: makes buttons uniform width */
  text-align: center;
}
.filter-btn:hover {
  background: #058091;
}
.filter-btn.active {
  background: #f6b400;
  color: rgb(252, 250, 250);
  font-weight: bold;
}


</style>

<div id="mipl2011Buttons" style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; margin-bottom: 10px;">

  <!-- BUTTONS -->
    <button class="filter-btn" id="searchBtn" data-mode="afisearch">üîç Searchbar</button>
    <button class="filter-btn" data-mode="DNAME">SEARCH BY DRUG NAME</button>
    <button class="filter-btn" data-mode="SALT">SEARCH BY DRUG SALT</button>
    <button class="filter-btn" id="pswBtn" data-mode="PSW">üìò ID/PASSWORD</button>
  <br><br>
</div>



<style>
  #search2011Bar {
    background-color: #027175; /* blue */
    width: 100%;
    height: 20px;
    display: flex;
    align-items: center;
    padding: 20px;
    gap: 10px;
    box-sizing: border-box;
  }

  #search2011Input {
    flex: 1;
    background-color: #fdfdf6; /* grey */
    border: none;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 14px;
    outline: none;
  }

  #search2011Bar label {
    font-weight: bold;
    color: rgb(247, 244, 244);
    margin-left: 10px;
  }

  #search2011Bar input[type="date"] {
    padding: 4px 6px;
    border-radius: 4px;
    border: 1px solid #ccc;
    font-size: 14px;
  }

 .dropdown {
  position: absolute;
  top: 130px;
  left: 0;
  right: 0;
  background: white;
  border: 4px solid #012228;
  max-height: 700px;
  width: 500px;
  overflow-y: auto;
  display: none;
  z-index: 100;
}

.dropdown div { padding: 6px; cursor: pointer; }
.dropdown div.active { background: #0078d4; color: white; }

.dropdown div:hover {
  background: #e8cd36;
  color: rgb(1, 3, 30);
  font-weight: bold;
}

 
</style>

<div id="search2011Bar">
 <!-- SEARCH INPUT -->
<input type="text" id="afiSearchInput" placeholder="Search..."
       style="display:none; padding:6px; width:100%; border-radius:6px; border:1px solid #ccc;" />

<!-- DROPDOWN (ONLY FOR DNAME + SALT) -->
<div id="afiDropdown" class="dropdown">
</div>
</div>

  <br>

  <!-- TABLE -->
  <div id="afiTableContainer"></div>

  <br>

  <!-- SALT MATCH BOX -->
  <div id="saltMatchBox" style="display:none; padding:10px; margin-bottom:10px;
       background:#fff8d1; border:1px solid #e5ce8e; border-radius:6px;">
  </div>

</div>
<script>
/* ============================================================
   API + SHEET CONFIG
============================================================ */
const api2011Key = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
const sheet2011Id = "1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k";

const rangeAFI = "AFI!A:M";
const rangeAFIPSW = "PASSWORD!A:M";


const afiSearchInput = document.getElementById("afiSearchInput");
const afiDropdown = document.getElementById("afiDropdown");

let afiData = [];
let pswData = [];
let colB = "";
let colC = "";
let colD = "";
let currentMode = "";

/* ============================================================
   TABLE CONFIG
============================================================ */
const tableConfig = {
  DNAME: { 
    headers: ["Sr No","Type","Drug Name","Salt","Qty","Rate","Amt","Unit","MRP","Q/U","P.Date","E.Date","Ledger"],
    cols:[0,1,2,3,4,5,6,7,8,9,10,11,12]
  },
  SALT: { 
    headers: ["Sr No","TYPE","SALT","Use / Kis mein hota hai","Drug Name","Category"],
    cols:[0,1,2,3,4,5]
  },
  afisearch: { 
    headers: ["Sr No","TYPE","SALT","Use / Kis mein hota hai","Drug Name","Category"],
    cols:[0,1,2,3,4,5]
  },
  PSW: { 
    headers: ["Sr No","TYPE","ID","PASSWORD","OTHER"],
    cols:[0,1,2,3,4]
  }
};

const saltBoxConfig = {
  headers: ["SALT","Use / Kis mein hota hai","Drug Name","Category"],
  cols:[2,3,4,5]
};

/* ============================================================
   LOAD AFI DATA (sorted)
============================================================ */
async function loadAFIData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheet2011Id}/values/${rangeAFI}?key=${api2011Key}`;
  const res = await fetch(url);
  const json = await res.json();

  const rows = json.values || [];
  const headers = rows[0];

  colB = headers[1];
  colC = headers[2];
  colD = headers[3];

  afiData = rows.slice(1).map(r => {
    let obj = {};
    headers.forEach((h,i)=> obj[h] = r[i] || "");
    return obj;
  });

  afiData.sort((a,b)=>(b[headers[0]]||"").localeCompare(a[headers[0]]||"",undefined,{numeric:true}));
}

/* ============================================================
   LOAD PASSWORD DATA
============================================================ */
async function loadPSWData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheet2011Id}/values/${rangeAFIPSW}?key=${api2011Key}`;
  const res = await fetch(url);
  const json = await res.json();

  const rows = json.values || [];
  const headers = rows[0];

  pswData = rows.slice(1).map(r => {
    let obj = {};
    headers.forEach((h,i)=> obj[h] = r[i] || "");
    return obj;
  });
}

/* ============================================================
   BUTTON MODE HANDLER
============================================================ */
document.querySelectorAll("#mipl2011Buttons .filter-btn").forEach(btn => {
  btn.addEventListener("click", function() {
    // Remove active from all buttons
    document.querySelectorAll("#mipl2011Buttons .filter-btn").forEach(b => b.classList.remove("active"));
    // Set current active
    this.classList.add("active");

    currentMode = btn.dataset.mode;

    afiSearchInput.style.display = "none";
    afiDropdown.style.display = "none";
    afiSearchInput.value = "";
    afiTableContainer.innerHTML = "";
    saltMatchBox.style.display = "none";

    /* üî• DROPDOWN ONLY FOR DNAME + SALT */
    if (currentMode !== "DNAME" && currentMode !== "SALT") {
      afiDropdown.style.display = "none";
    }

    /* üîç Global search */
    if (currentMode === "afisearch") { 
      afiSearchInput.style.display = "block";
      startAFISearchMode(); 
      return; 
    }

    /* üîë Password search */
    if (currentMode === "PSW") { 
      afiSearchInput.style.display = "block";
      startPSWSearchMode(); 
      return; 
    }

    /* DNAME + SALT actual searching */
    let filtered = afiData.filter(r => (r[colB]||"").trim().toUpperCase() === currentMode);

    /* Sorted unique dropdown list */
    let uniqueList = [...new Set(filtered.map(r => r[colC]).filter(Boolean))]
                       .sort((a,b)=>a.localeCompare(b));

    showAFITable(filtered);

    /* dropdown only shown for these two */
    if (currentMode === "DNAME" || currentMode === "SALT") {
      createAFIDropdown(uniqueList, filtered);
    }
  });
});

/* ============================================================
   DROPDOWN SHOW ONLY ON INPUT CLICK (DNAME+SALT)
============================================================ */
afiSearchInput.addEventListener("click", () => {
  if (
    (currentMode === "DNAME" || currentMode === "SALT") &&
    afiDropdown.innerHTML.trim() !== ""
  ) {
    afiDropdown.style.display = "block";
  }
});

/* ============================================================
   CREATE DROPDOWN
============================================================ */

function createAFIDropdown(list, filteredRows) {

  // Sort alphabetically always
  list.sort((a, b) => a.localeCompare(b));

  afiSearchInput.style.display = "block";

  // üëâ Input click ‚Üí Always show full dropdown
  afiSearchInput.addEventListener("click", () => {
    renderDropdown(list, filteredRows);
  });

  // üëâ Typing filter logic
  afiSearchInput.oninput = () => {
    const v = afiSearchInput.value.toLowerCase().trim();

    let filteredList = (v === "")
      ? list
      : list.filter(x => x.toLowerCase().includes(v));

    filteredList.sort((a, b) => a.localeCompare(b));

    renderDropdown(filteredList, filteredRows);
  };

  // üëâ Click outside ‚Üí Hide dropdown
  document.addEventListener("click", function (e) {
    if (!afiSearchInput.contains(e.target) && !afiDropdown.contains(e.target)) {
      afiDropdown.style.display = "none";
    }
  });
}


/* ============================================================
   RENDER DROPDOWN ITEMS
   ============================================================ */
function renderDropdown(values, filteredRows) {

  // Only show dropdown in DNAME or SALT modes
  if (currentMode !== "DNAME" && currentMode !== "SALT") {
    afiDropdown.style.display = "none";
    return;
  }

  afiDropdown.innerHTML = "";
  afiDropdown.style.display = "block";

  values.forEach(v => {
    let item = document.createElement("div");
    item.textContent = v;

    item.onclick = () => {
      afiDropdown.style.display = "none";
      afiSearchInput.value = v;

      // Filter table rows based on selected dropdown value
      let rows = filteredRows.filter(r => r[colC] === v);
      showAFITable(rows);

      if (currentMode === "DNAME") {
        findSaltRowAndShow(rows[0][colD]);
      }
    };

    afiDropdown.appendChild(item);
  });
}

/* ============================================================
   SALT MATCH BOX
============================================================ */
function findSaltRowAndShow(drugName) {
  const box = document.getElementById("saltMatchBox");

  const matched = afiData.filter(
    r => r[colB] === "SALT" && r[colC] === drugName
  );

  if (!matched.length) {
    box.innerHTML = "<b>No Salt Detail Found</b>";
    box.style.display = "block";
    return;
  }

  let html = `<h4>üîç Salt Match</h4><table border="1" cellpadding="6" style="width:100%; border-collapse:collapse;">`;

  html += "<tr>";
  saltBoxConfig.headers.forEach(h => html += `<th>${h}</th>`);
  html += "</tr>";

  matched.forEach(r => {
    html += "<tr>";
    saltBoxConfig.cols.forEach(c => html += `<td>${Object.values(r)[c]}</td>`);
    html += "</tr>";
  });

  html += "</table>";

  box.innerHTML = html;
  box.style.display = "block";
}

/* ============================================================
   GLOBAL SEARCHBAR
============================================================ */
function startAFISearchMode() {
  afiSearchInput.oninput = () => {
    let v = afiSearchInput.value.toLowerCase();

    let rows = afiData.filter(r =>
      Object.values(r).join(" ").toLowerCase().includes(v)
    );

    rows = highlightMatch(rows, v);
    showAFITable(rows);
  };
}

/* ============================================================
   PASSWORD SEARCH
============================================================ */
function startPSWSearchMode() {
  afiSearchInput.oninput = () => {
    let v = afiSearchInput.value.toLowerCase();

    let rows = pswData.filter(r =>
      Object.values(r).join(" ").toLowerCase().includes(v)
    );

    rows = highlightMatch(rows, v);
    showPSWTable(rows);
  };
}

/* ============================================================
   HIGHLIGHT MATCH
============================================================ */
function highlightMatch(rows, text) {
  if (!text) return rows;

  return rows.map(r => {
    let obj = {};
    Object.keys(r).forEach(k => {
      obj[k] = r[k].replace(new RegExp(text,"gi"), m => `<mark>${m}</mark>`);
    });
    return obj;
  });
}

/* ============================================================
   SHOW AFI TABLE
============================================================ */
function showAFITable(rows) {
  const box = afiTableContainer;
  const cfg = tableConfig[currentMode];

  if (!rows.length) {
    box.innerHTML = "<p>No Data Found</p>";
    return;
  }

  let html = `<table border="1" cellpadding="5" style="width:100%; border-collapse:collapse;">`;

  html += "<tr>";
  cfg.headers.forEach(h => html += `<th>${h}</th>`);
  html += "</tr>";

  rows.forEach(r => {
    html += "<tr>";
    cfg.cols.forEach(c => html += `<td>${Object.values(r)[c]||""}</td>`);
    html += "</tr>";
  });

  html += "</table>";
  box.innerHTML = html;
}

/* ============================================================
   SHOW PASSWORD TABLE
============================================================ */
function showPSWTable(rows) {
  const box = afiTableContainer;
  const cfg = tableConfig["PSW"];

  if (!rows.length) {
    box.innerHTML = "<p>No Data Found</p>";
    return;
  }

  let html = `<table border="1" cellpadding="5" style="width:100%; border-collapse:collapse;">`;

  html += "<tr>";
  cfg.headers.forEach(h => html += `<th>${h}</th>`);
  html += "</tr>";

  rows.forEach(r => {
    html += "<tr>";
    cfg.cols.forEach(c => html += `<td>${Object.values(r)[c]||""}</td>`);
    html += "</tr>";
  });

  html += "</table>";
  box.innerHTML = html;
}

/* ============================================================
   LOAD ALL DATA
============================================================ */
loadAFIData();
loadPSWData();
</script>




















<script>
// üîÑ Page refresh hote hi password ki memory clear
window.addEventListener("load", function () {
    localStorage.removeItem("pswVerified");
});

// üîç F2 key press ‚Üí search input show + focus
document.addEventListener("keydown", function (e) {
    if (e.key === "F2") {
        const inp = document.getElementById("afiSearchInput");
        inp.style.display = "block";   // show input
        inp.focus();                   // cursor focus
    }
});

document.getElementById("pswBtn").addEventListener("click", function () {

    const correctPassword = "5792"; // ‚≠ê Apna password set karein

    // Agar already verified hai to seedha script run ho jaye
    if (localStorage.getItem("pswVerified") === "true") {
        proceed();
        return;
    }

    let userInput = "";

    // üîÅ Jab tak password correct na ho prompt baar-baar open hoga
    while (userInput !== correctPassword) {

        userInput = prompt("Please enter password:");

        // ‚ùó CANCEL ‚Üí Page reload (no alert)
        if (userInput === null) {
            location.reload(); 
            return;
        }

        // ‚ùå Wrong password
        if (userInput !== correctPassword) {
            alert("‚ùå Incorrect Password! Try again.");
        }
    }

    // ‚úî Password correct ‚Üí save verification
    localStorage.setItem("pswVerified", "true");

    proceed(); 
});

function proceed() {
    alert("‚úî Access Granted!");
    console.log("Password correct ‚Äî proceeding with main script...");
}
</script>
